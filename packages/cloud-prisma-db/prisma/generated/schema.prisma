generator client {
  provider = "prisma-client-js"
  output   = "./generated"
  binaryTargets = ["linux-musl-openssl-3.0.x","darwin-arm64"]
}

generator zod {
  provider    = "zod-prisma"
  modelSuffix = "CloudModel"
  output      = "../../shared-types/src/cloud-prisma-types"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev(cloud).db"
}

model Country {
  id        Int        @id @default(autoincrement())
  name      String
  code      String
  locations Location[]
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
}

model User {
  id         Int      @id @default(autoincrement())
  email      String
  birthDay   DateTime
  name       String?
  locationId Int
  cardNumber String   @unique
  isAllowed  Boolean  @default(false)
  location   Location @relation(fields: [locationId], references: [id])
  visits     VisitsToLocation[]
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
}

model VisitsToLocation {
  id         Int      @id @default(autoincrement())
  userId     Int
  user       User     @relation(fields: [userId], references: [id])
  locationId Int
  location   Location @relation(fields: [locationId], references: [id])
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
}

model Location {
  id        Int       @id @default(autoincrement())
  name      String
  users     User[]
  devices   Devices[]
  lat String
  long String
  countryId Int
  country   Country   @relation(fields: [countryId], references: [id])
  visits    VisitsToLocation[]
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}

model Devices {
  id           Int         @id @default(autoincrement())
  name         String
  deviceId     String
  locationId   Int
  location     Location    @relation(fields: [locationId], references: [id])
  deviceType   DeviceTypes @relation(fields: [deviceTypeId], references: [id])
  deviceTypeId Int
  createdAt    DateTime    @default(now())
  updatedAt    DateTime    @updatedAt
}

model DeviceTypes {
  id        Int       @id @default(autoincrement())
  name      String
  devices   Devices[]
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}
